ext.gitBranch = {
    def branchFile = new File(rootProject.projectDir, ".git")
    if (branchFile.exists() == false) {
        return null
    }
    
    new ByteArrayOutputStream().withStream { os ->
        def result = exec {
            executable = "git branch | grep \\* | cut -d ' ' -f2"
            standardOutput = os
        }
        return os.toString()
    }
    return null
}

ext.hgFeature = {
    def featurePrefix = "feature/"
    def branch = gitBranch();
    if (branch == null) {
        return null;
    }
    if (branch?.startsWith(featurePrefix)) {
        def feature = branch.substring(featurePrefix.length()).replaceAll(' ', '_');
        return feature;
    }
    return null;
}